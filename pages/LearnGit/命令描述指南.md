# Git冒险 - 命令描述指南

## 概述

本指南详细说明如何为「Git冒险」游戏添加新的Git命令支持。在游戏中，每个命令都通过一个结构化的配置对象来定义，包含命令的基本信息和执行逻辑。

## 命令配置结构

一个完整的命令配置对象应包含以下字段：

```javascript
'command-name': {
  description: '命令的简要描述',
  example: '命令使用示例',
  execute: function(args) {
    // 命令执行逻辑
    return '命令执行结果';
  }
}
```

## 字段详细说明

### command-name

命令的完整名称，作为配置对象的键。对于Git命令，应该包含"git"前缀，例如"git init"、"git add"等。

### description

一个字符串，提供命令的简要描述，说明该命令的功能和用途。这个描述会显示在命令列表模态框中。

### example

一个字符串，展示命令的典型用法示例。这个示例也会显示在命令列表模态框中。

### execute

一个函数，定义命令的执行逻辑。该函数接收命令参数数组作为输入，返回命令的输出结果字符串。

函数签名：
```javascript
execute: function(args) {
  // 处理逻辑
  return outputString;
}
```

## 实现命令执行逻辑

在`execute`函数中，你可以访问和修改游戏的状态。游戏状态保存在`GitAdventureGame.gameState`对象中，主要包括：

```javascript
GitAdventureGame.gameState = {
  repository: {
    files: {},               // 已跟踪的文件
    commits: [],             // 提交历史
    currentBranch: 'master', // 当前分支
    branches: ['master'],    // 所有分支
    stagedChanges: {},       // 暂存区的变更
    untrackedFiles: {},      // 未跟踪的文件
    status: {}               // 状态信息
  }
}
```

### 处理参数

命令参数通过`args`数组传递给`execute`函数。例如，对于命令`git add file1.txt file2.txt`，`args`数组将是`['file1.txt', 'file2.txt']`。

### 返回结果

`execute`函数应该返回一个字符串，表示命令的执行结果。这个结果将显示在终端中。

## 命令示例

以下是一个完整的命令配置示例：

```javascript
'git status': {
  description: '显示工作目录和暂存区的状态',
  example: 'git status',
  execute: function(args) {
    let output = '在分支 ' + GitAdventureGame.gameState.repository.currentBranch + '\n';
    
    if (Object.keys(GitAdventureGame.gameState.repository.untrackedFiles).length > 0) {
      output += '\n未跟踪的文件:\n  (使用 "git add <file>..." 以包含要提交的内容)\n';
      for (let file in GitAdventureGame.gameState.repository.untrackedFiles) {
        output += '\t' + file + '\n';
      }
    }
    
    if (Object.keys(GitAdventureGame.gameState.repository.stagedChanges).length > 0) {
      output += '\n要提交的变更:\n  (使用 "git commit" 提交)\n';
      for (let file in GitAdventureGame.gameState.repository.stagedChanges) {
        output += '\t新增:     ' + file + '\n';
      }
    }
    
    return output;
  }
}
```

## 添加新命令的步骤

1. **确定命令功能**：明确新命令的具体功能和行为
2. **编写命令配置**：创建包含description、example和execute函数的配置对象
3. **实现执行逻辑**：在execute函数中实现命令的具体行为
4. **添加到命令对象**：将命令配置添加到`GitAdventureGame.commands`对象中
5. **测试命令**：确保命令在游戏中能够正确工作

## 更新命令列表

将新命令添加到游戏中后，它会自动显示在命令列表模态框中，无需额外配置。

## 命令实现最佳实践

1. **模拟真实行为**：尽量模拟Git命令的真实行为和输出格式
2. **提供有意义的错误信息**：当命令使用不正确时，提供清晰的错误提示
3. **保持简单**：对于复杂命令，可以实现核心功能，而不必模拟所有边缘情况
4. **更新游戏状态**：确保命令执行后正确更新游戏的状态
5. **提供帮助信息**：在命令描述中提供足够的信息，帮助用户理解命令的用途

## 高级功能

### 命令别名

可以为命令添加别名，例如：

```javascript
'git checkout': {
  description: '切换分支或恢复工作树文件',
  example: 'git checkout branch-name',
  execute: function(args) {
    // 实现逻辑
  }
},
'git co': {
  description: 'checkout的别名',
  example: 'git co branch-name',
  execute: function(args) {
    // 调用主命令的execute函数
    return GitAdventureGame.commands['git checkout'].execute(args);
  }
}
```

### 处理复杂选项

对于带有多个选项的命令，可以使用以下方式处理：

```javascript
'git commit': {
  description: '创建一个新的提交',
  example: 'git commit -m "提交信息"',
  execute: function(args) {
    let message = '默认提交信息';
    
    // 处理-m选项
    if (args.length >= 2 && args[0] === '-m') {
      message = args.slice(1).join(' ');
    }
    
    // 执行提交逻辑
    // ...
    
    return `[分支名] ${message}`;
  }
}
```

## 调试提示

1. 使用`console.log()`来输出命令参数和游戏状态，帮助调试
2. 在实现新命令前，先在现有命令的基础上修改和测试
3. 对于复杂命令，可以分步骤实现，逐步测试每个功能点