# Git冒险 - 关卡配置指南

## 概述

本指南详细说明如何为「Git冒险」游戏创建新的关卡配置文件。每个关卡都通过一个结构化的配置对象来定义，包含关卡的基本信息、初始状态和完成条件。

## 关卡配置结构

一个完整的关卡配置对象应包含以下字段：

```javascript
{
  id: 1,                        // 关卡唯一标识符
  title: '关卡标题',             // 关卡标题
  description: '关卡描述...',     // 关卡描述和任务说明
  initialState: {               // 关卡初始状态
    repository: {               // Git仓库初始状态
      files: {},               // 仓库中的文件
      commits: [],             // 提交历史
      currentBranch: 'master', // 当前分支
      branches: ['master'],    // 所有分支
      stagedChanges: {},       // 暂存区的变更
      untrackedFiles: {},      // 未跟踪的文件
      status: {}               // 状态信息
    }
  },
  completionCondition: function(state) { // 完成条件判断函数
    return true; // 返回true表示关卡完成
  }
}
```

## 字段详细说明

### id

关卡的唯一数字标识符。建议按照顺序从1开始编号，确保每个关卡都有唯一的ID。

### title

关卡的标题，应该简洁明了地描述关卡的主题或重点内容。

### description

关卡的详细描述，包括：
- 欢迎信息和背景介绍
- 明确的任务列表
- 可能的提示或指导

可以使用换行符(`\n`)来格式化文本，使其在游戏界面中显示更加清晰。

### initialState

定义关卡开始时的仓库状态：

#### repository.files

一个对象，键为文件名，值为文件内容。表示已经被跟踪并提交到仓库中的文件。

```javascript
files: {
  'README.md': '# 项目说明\n这是一个示例文件。',
  'index.html': '<html>\n<body>\n<h1>Hello World</h1>\n</body>\n</html>'
}
```

#### repository.commits

一个数组，包含仓库的提交历史。每个提交对象应包含：
- `id`: 提交的唯一标识符
- `message`: 提交信息
- `changes`: 该提交包含的文件变更
- `timestamp`: 提交时间戳

```javascript
commits: [{
  id: 'initial-commit',
  message: '初始提交',
  changes: {
    'README.md': '# 项目说明'
  },
  timestamp: new Date().toISOString()
}]
```

#### repository.currentBranch

字符串，表示当前所在的分支名称。默认为'master'。

#### repository.branches

一个数组，包含仓库中的所有分支名称。

#### repository.stagedChanges

一个对象，表示已经添加到暂存区但尚未提交的文件。

#### repository.untrackedFiles

一个对象，表示尚未被Git跟踪的文件。

### completionCondition

一个函数，接收当前游戏状态作为参数，返回布尔值表示关卡是否完成。

这个函数应该检查游戏状态，判断玩家是否完成了所有必要的任务。

```javascript
completionCondition: (state) => {
  // 检查是否有至少一次提交
  // 检查是否包含特定文件
  return state.repository.commits.length > 0 && 
         state.repository.files['README.md'] !== undefined;
}
```

## 创建新关卡的步骤

1. **确定关卡主题**：选择一个Git概念或命令作为关卡的核心内容
2. **设计任务流程**：规划玩家需要完成的具体步骤
3. **设置初始状态**：决定关卡开始时仓库的状态
4. **编写完成条件**：定义如何判断玩家是否成功完成关卡
5. **测试关卡**：确保关卡难度适中，并且完成条件能够正确判断

## 关卡示例

以下是一个完整的关卡配置示例：

```javascript
{
  id: 1,
  title: 'Git基础 - 初始化仓库',
  description: '欢迎来到Git冒险！在这个关卡中，你需要初始化一个Git仓库，并创建你的第一个提交。\n\n任务：\n1. 初始化一个Git仓库\n2. 创建一个README.md文件\n3. 将文件添加到暂存区\n4. 创建一个提交',
  initialState: {
    repository: {
      files: {},
      commits: [],
      currentBranch: 'master',
      branches: ['master'],
      stagedChanges: {},
      untrackedFiles: {},
      status: {}
    }
  },
  completionCondition: (state) => {
    return state.repository.commits.length > 0 && 
           state.repository.files['README.md'] !== undefined;
  }
}
```

## 关卡设计最佳实践

1. **由简到难**：关卡应该按照难度递增的顺序排列
2. **专注单一概念**：每个关卡最好聚焦于一个特定的Git概念或命令
3. **提供明确指导**：任务描述应该清晰明确，避免歧义
4. **设置合理检查点**：确保完成条件能够准确反映玩家是否掌握了相关概念
5. **添加适当提示**：对于较难的关卡，可以在描述中提供一些提示

## 将关卡添加到游戏中

要将新关卡添加到游戏中，需要将关卡配置对象添加到`game.js`文件的`levels`数组中。